(function(c){function tb(){I=c(window);$b=c("body");Ya=c("body, html");v=c("<div />").addClass("jackbox-modal");s=c("<div />").addClass("jackbox-holder");ha=c("<div />").addClass("jackbox-wrapper");Y=c("<div />").addClass("jackbox-preloader");ia=c("<span />").addClass("jackbox-panel jackbox-panel-left");sa=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=r.createDocumentFragment();a.appendChild(ha[0]);a.appendChild(Y[0]);v[0].appendChild(a);a=r.createDocumentFragment();a.appendChild(ia[0]); a.appendChild(sa[0]);a.appendChild(s[0]);ha[0].appendChild(a);ja=c("<div />").addClass("jackbox-container");ta||(a=c("<span />").addClass("jackbox-pre-outside").appendTo(Y),c("<span />").addClass("jackbox-pre-inside").appendTo(a));Z*=2;Na=0;a=r.createDocumentFragment();ub&&(A=c(ub).hide(),a.appendChild(A[0]));a.appendChild(ja[0]);vb&&(B=c(vb).hide(),a.appendChild(B[0]));s[0].appendChild(a);wb=-(F+Da);ua=[];Oa=[];J=[];K=[];xb.each(Uc);V&&(c.address.internalChange(yb),c.address.externalChange(Vc)); ac=!0;Pa&&(V?setTimeout(Pa,250):Pa(),Pa=null);xb=Oa=ub=vb=ua=null}function bc(a,b){var d=c(this),n=K.length,g=-1,e,m;if(a&&"object"===typeof a){var f,k=d.attr("href");for(m in a)a.hasOwnProperty(m)&&"trigger"!==m&&(f=a[m],"href"===m&&k||d.attr("data-"+m,f),"group"===m&&(e=f))}e||(e=d.attr("data-group"));if(e){for(e=e.split(" ").join("").toLowerCase();n--;)if(K[n]===e){g=n;break}if(-1<g){e=J[g];for(n=e.length;n--;)if(m=e[n],m[0]===d[0]){if(b)if(e.splice(n,1),m.off("click.jackbox"),d=e.length)for(g= 0;g<d;g++)e[g].data("id",g);else J.splice(g,1),K.splice(g,1),Qa--;return}n=e.length;e[n]=d}else{if(b)return;g=K.length;n=J.length;K[g]=e;Qa++;J[n]=[d];n=0}cc(d);d.data({id:n,cat:g});a&&a.trigger&&d.trigger("click")}}function Uc(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(ta){for(var b=K.length,d=!1;b--;)if(K[b]===a){d=!0;break}d||dc(a)}else-1===K.indexOf(a)&&dc(a)}function dc(a){K[K.length]=a;Oa=[];c(ec+"[data-group="+a+"]").each(cc);J[J.length]=Oa;Qa++}function cc(a){isNaN(a)? e=a:(e=c(this).data({id:a,cat:Qa}),Oa[a]=e);if(h=e.attr("href")||e.attr("data-href")){var b;a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop():"inline";if(b=-1!==h.search("youtube.com")?"youtube":-1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1)e.data("type",b),e.attr("data-thumbnail")||("vimeo"===b?Wc(e,h):"youtube"===b&&e.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg"));else if("jpg"===a||"png"===a||"jpeg"===a||"gif"===a)e.data("type", "image");else switch(a){case "mp3":e.data("type","audio");break;case "swf":e.data("type","swf");break;case "inline":e.data("type","inline");break;default:e.data("type","iframe")}e.on("click.jackbox",Xc);if(P=e.attr("data-description")){if(ua)if(a=ua.indexOf(P),-1===a){P=c(P);if(!P.length)return;ua[ua.length]=P}else P=ua[a];else if(P=c(P),!P.length)return;e.data("description",P)}}}function Vc(a){if(fc){fc=!1;var b=r.URL.split("?url=");if(2===b.length){window.location=b[0]+"#/"+b[1];return}}clearTimeout(Ra); gc(a.value);-1!==G?hc?(hc=!1,yb()):Ra=setTimeout(yb,750):$&&zb()}function yb(a){"object"===typeof a&&(clearTimeout(Ra),gc(a.value));-1!==G?ic():$&&zb()}function gc(a){!L||(ka||Ea)||w[f].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(f=parseInt(a[2],10)-1,isNaN(f)&&(f=0),la=a[1]):isNaN(a[1])?(f=0,la=a[1]):(f=parseInt(a[1],10)-1,la="/")):(la="/",f=0);if("/"!==la)for(a=Qa;a--;){if(K[a]===la){G=a;Q=J[G].length;W=1!==Q;break}}else G=-1;Ea=!1}function Za(){clearTimeout(jc);jc=setTimeout(ma, 100)}function Xc(a){a.stopPropagation();a.preventDefault();a=c(this).data();$a(a.cat,a.id,!0)}function $a(a,b,d){clearTimeout(Ra);if(!d){if(L)for(d=w.length;d--;)w[d].off("click.jackbox");ia.off(".jackbox");sa.off(".jackbox");Fa&&Ga.off("keydown.jackbox");t&&Ab&&k.cjSwipe("unbindSwipe")}V?c.address.value(K[a]+"/"+(b+1)):(!L||(ka||Ea)||w[f].removeClass("jb-thumb-active"),f=b,G=a,Q=J[G].length,W=1!==Q,ic())}function ab(a){if(a&&(a.stopPropagation(),Sa))return!1;$&&(L&&!ka&&w[f].removeClass("jb-thumb-active"), f<J[G].length-1?f++:f=0,Ea=!0,$a(G,f))}function bb(a){if(a&&(a.stopPropagation(),Sa))return!1;$&&(L&&!ka&&w[f].removeClass("jb-thumb-active"),0<f?f--:f=J[G].length-1,Ea=!0,$a(G,f))}function kc(){for(var a=[v[0],ha[0],s[0],ja[0]],b=4;b--;)a[b].removeEventListener("touchstart",C,!1),a[b].removeEventListener("touchmove",C,!1),a[b].removeEventListener("touchend",C,!1)}function ic(){cb=J[G];if(e=cb[f]){if(t)for(var a=[v[0],ha[0],s[0],ja[0]],b=4;b--;)a[b].addEventListener("touchstart",C,!1),a[b].addEventListener("touchmove", C,!1),a[b].addEventListener("touchend",C,!1);h=e.attr("href")||e.attr("data-href");if($)Sa=!0,lc(),mc();else{$=!0;t||Ya.stop();Na=I.scrollTop();v.appendTo($b).one("click.jackbox",Bb);Ha||(nc=v.parents().each(Yc));if(Fa)Ga.on("keydown.jackbox_keyboard",Zc);oc||(oc=!0,db=parseInt(s.css("padding-left"),10)+parseInt(s.css("padding-right"),10),Ia=parseInt(s.css("padding-top"),10)+parseInt(s.css("padding-bottom"),10),Cb=parseInt(ia.css("width"),10)+14,eb=Ia+Z,Db=F+(Da<<1),fb=parseInt(Y.css("margin-top"), 10),pc=fb-(Db>>1),qc=parseInt(s.css("padding-left"),10),rc=parseInt(s.css("padding-top"),10),R=c(".jackbox-fullscreen"),R.length||(R=null),va=!t&&"safari"!==gb&&("webkitRequestFullScreen"in v[0]||"mozFullScreenEnabled"in r));na=!Eb&&hb&&W?0:wb;H=I.width();M=I.height();s.css({width:H,height:M,marginLeft:-(H>>1)-qc,marginTop:-(M>>1)-rc});Jacked.fadeIn(v[0],{callback:$c});sc=setTimeout(mc,250);ha.on("click.jackbox",tc)}}}function Yc(){c(this).addClass("jackbox-overflow")}function ad(){c(this).removeClass("jackbox-overflow")} function $c(){Ha||I[0].scrollTo(0,0)}function mc(){L&&(w[f].addClass("jb-thumb-active"),ka?ka=!1:uc(!1,!0));var a;a=e.attr("data-autoplay")?e.attr("data-autoplay"):vc;a="true"===a||!0===a;var b=e.data("description")||null,d=e.attr("data-title")||"",n;ib="true"===e.attr("data-scaleUp");jb=b&&"string"!==typeof b?b.html():!1;N=e.data("type");a="true"===a||!0===a;d?(Fb=d,oa=escape(Fb)):(oa=!1,"undefined"!==typeof D&&(D.data("links")&&D.data("links").off(".jackbox"),D.empty()));t&&(Ab="image"===N,"inline"!== N&&"iframe"!==N&&r.addEventListener("touchmove",C,!1));"image"!==N&&wc();kb=!1;568<H?Y.css("margin-top",0===na?pc:fb):Y.css("margin-top",fb);ha.show();Y.addClass("jackbox-spin-preloader");switch(N){case "image":Ta=!0;k=c("<img />").addClass("jackbox-content").one("load.jackbox",lb).prependTo(ja);t&&(k[0].addEventListener("touchstart",C,!1),k[0].addEventListener("touchmove",C,!1),k[0].addEventListener("touchend",C,!1));k.attr("src",h);break;case "youtube":t&&(kb=!0);Ja(bd.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join(a? 1:0));break;case "vimeo":Ja(cd.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a));break;case "local":var b=Gb(),d="true"===e.attr("data-firefoxUsesFlash")?"true":"false",g=e.attr("data-flashHasPriority")?e.attr("data-flashHasPriority"):xc.toString();n="false"===g&&va&&"firefox"!==gb;b=e.attr("data-poster")?b+e.attr("data-poster"):"false";Ja(Hb+"?video="+h+"&autoplay="+a+"&flashing="+g+"&width="+S+"&height="+T+"&poster="+b+"&firefox="+d,!0);break;case "audio":Gb();Ja(Ib+ "?audio="+h+"&title="+(e.attr("data-audiotitle")?e.attr("data-audiotitle"):oa)+"&autoplay="+a);break;case "swf":Gb();Ja(Jb+"?swf="+h+"&width="+(q.toString()+"&height="+p.toString()));break;case "inline":a=c(h);a=a.length?a.html():"";k=c("<div />").addClass("jackbox-content jackbox-html").html(a).prependTo(ja);k.css("width",q).find("a").on("click",pa);e.attr("data-height",k.outerHeight(!0));wc();lb();break;default:Ja(h,!1,!0)}va&&(n?R.hide():R.show())}function Gb(){if(-1!==h.search("http"))return""; var a=r.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}function dd(a){switch(a.keyCode){case 39:ab();break;case 37:bb();break;case 40:Kb();break;case 38:Kb()}}function Zc(a){27===a.keyCode&&Bb(a)}function ed(){E.css("visibility","hidden")}function fd(){u.data("offLeft",u.offset().left)}function yc(){Ka.css({opacity:0,visibility:"hidden"})}function zc(a){"object"===typeof a&&a.stopPropagation();x<Q-qa&&(x++,Lb(!1,!0))}function Ac(a){"object"===typeof a&& a.stopPropagation();0<x&&(x--,Lb(!1,!0))}function gd(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");t||a.addClass("jb-thumb-hover");a.data("id")===f&&a.addClass("jb-thumb-active")}function Bc(a){a.stopPropagation();if(Sa)return!1;a=c(this).data("id");a!==f&&(L&&w[f].removeClass("jb-thumb-active"),f=a,ka=!0,$a(G,f))}function hd(){Ua?Cc():(I.off(".jackbox"),Ua=!0,r.mozFullScreenEnabled?(r.addEventListener("mozfullscreenchange",mb,!1),v[0].mozRequestFullScreen()):v[0].webkitRequestFullScreen&& (r.addEventListener("webkitfullscreenchange",mb,!1),v[0].webkitRequestFullScreen()))}function mb(){r.webkitIsFullScreen||r.mozFullScreen?ma():Cc(!0)}function Mb(a){r.removeEventListener(a.type,Mb,!1);ma();I.on("resize.jackbox",Za)}function Cc(a){Ua=!1;r.mozFullScreenEnabled?(r.removeEventListener("mozfullscreenchange",mb,!1),a?(ma(),I.on("resize.jackbox",Za)):(r.addEventListener("mozfullscreenchange",Mb,!1),r.mozCancelFullScreen())):v[0].webkitRequestFullScreen&&(r.removeEventListener("webkitfullscreenchange", mb,!1),a?(ma(),I.on("resize.jackbox",Za)):(r.addEventListener("webkitfullscreenchange",Mb,!1),r.webkitCancelFullScreen()))}function wc(){Ta=!1;S=e.attr("data-width")?parseInt(e.attr("data-width"),10):Dc;T=e.attr("data-height")?parseInt(e.attr("data-height"),10):Ec;ib="true"===e.attr("data-scaleUp");Fc()}function Fc(){nb=S+db+Cb+Z;Nb=T+eb;ma("true")}function lc(){clearTimeout(sc);Jacked.stopTween(s[0]);I.off(".jackbox");t&&r.removeEventListener("touchmove",C,!1);k&&(Jacked.stopTween(k[0]),k.remove(), k=null);ob&&(ob.remove(),ob=null);A&&(Jacked.stopTween(A[0],!0),A.hide());B&&(Jacked.stopTween(B[0],!0),B.hide());y&&(y.removeClass("jb-info-inactive"),Jacked.stopTween(O[0]),O.empty().hide())}function Bb(a){a.stopPropagation();V?c.address.value(""):zb()}function zb(){clearTimeout(Ra);lc();v.unbind(".jackbox");Fa&&Ga.off("keydown.jackbox_keyboard");if(W){Fa&&Ga.off("keydown.jackbox");wa&&wa.off(".jackbox");xa&&xa.off(".jackbox");Va&&u&&u.off(".jackbox");Jacked.stopTween(sa[0],!0);Jacked.stopTween(ia[0], !0);var a={opacity:0,visibility:"hidden"};sa.off(".jackbox").css(a);ia.off(".jackbox").css(a)}else ya&&ya.show(),z&&z.show();ha.hide().off(".jackbox");Y.removeClass("jackbox-spin-preloader");"undefined"!==typeof D&&(D.data("links")&&D.data("links").off(".jackbox"),D.empty());va&&R.off(".jackbox");za&&za.unbind(".jackbox");y&&y.off(".jackbox");if(L){Jacked.stopTween(aa[0]);for(aa.off(".jackbox").hide();w.length;)a=w[0],Jacked.stopTween(a[0]),a.remove(),w.shift();ba.off(".jackbox").hide();ca.off(".jackbox").hide(); t&&u.cjSwipe("unbindSwipe");Jacked.stopTween(U[0]);U.empty().css("margin-left",0);z&&(z.off(".jackbox"),z&&(X.hide(),da.show()));L=w=null}Ha||nc.each(ad);Jacked.fadeOut(v[0],{duration:1E3,callback:id});s.css({marginLeft:jd,marginTop:kd});t&&(kc(),r.removeEventListener("touchmove",C,!1));setTimeout(ld,10);E&&(E.css("visibility","hidden"),t&&(E[0].removeEventListener("touchstart",pa,!1),E[0].removeEventListener("touchmove",pa,!1),E[0].removeEventListener("touchend",pa,!1)));e=$=Ua=ka=Ob=pb=Ea=Pb=La= null}function ld(){0!==Na&&(Ha||t?Ya.scrollTop(Na):Ya.animate({scrollTop:Na},{duration:300,queue:!1}))}function id(){v.detach()}function md(a){a?bb():ab()}function C(a){a.preventDefault()}function nd(a,b){if(!$&&"success"===b.toLowerCase()&&a){var d=a.length,n=document.URL;for(n.substring(0,n.lastIndexOf("/"));d--;)c("<img />").attr("src",ra+"/"+a[d].split("../").join(""))}}function Wc(a,b){c.getJSON("http://vimeo.com/api/v2/video/"+b.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"}, function(b){a.attr("data-thumbnail",b[0].thumbnail_small)})}function od(){var a=c(this),b=a.next("img"),d=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",pd).insertAfter(b),b.remove(),a.attr("src",d))}function pd(){var a=c(this),b=a.data("parent"),d=parseInt(b.css("width"),10)||b.width(),n=parseInt(b.css("height"),10)||b.height(),b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:d,height:n}).insertBefore(b), n=Date.now(),d=n+1,n=n+2;a.attr("id",d);b.attr("id",n);StackBlurImage(d,n,29)}function qd(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",rd).on("mouseleave.jackbox",sd)}function rd(){var a=c(this),b=a.offset(),d=a.data();d.tipX=b.left;d.tipY=b.top;d.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox",td)}function sd(){var a=c(this).off("mousemove.jackbox");ta?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0, visibility:"hidden"})}function pa(a){a.stopImmediatePropagation()}function tc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var l={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540,thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,dynamic:!1,baseName:"jackbox",className:".jackbox",preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,showPageScrollbar:!1,useKeyboardControls:!0,fullscreenScalesContent:!0,defaultShareImage:"jackbox/img/default_share.jpg"}, Z=10,Da=2,Qb="/php/graphics.php",Jb="/modules/jackbox_swf.html",Rb="/img/thumbs/default.jpg",Hb="/modules/jackbox_video.html",Ib="/modules/jackbox_audio.html",Sb="/modules/jackbox_social.php",cd="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent",bd="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",ub='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />', vb='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>', jc,B,va,qc,rc,Tb,Db,qb,wb,Ua,Ub,Gc,Ia,db,Hc,E,Cb,Vb,U,u,Wb,ca,A,O,ea,X,da,sa,R,Na,ia,oa,ba,ja,Y,qa,ua,Xb,Fb,Ab,ec,ra,La,Ka,na,z,za,jb,ya,Ic,Va,Jc,Aa,Ma,x,ha,Ba,xa,W,fb,wa,ib,Kc,t,eb,rb,Wa,v,D,e,Oa,y,Ga,r,h,q,I,Q,Lc,K,p,la,J,ta,Ca,Yb,sc,Pa,w,$b,s,xb,S,sb,Ra,Mc,k,T,Ta,H,M,nb,Nb,N,nc,gb,fa,P,$,oc,Ya,Fa,kb,hb,Sa,ka,L,kd,Ob,cb,Ha,V,Xa,ob,aa,pb,pc,jd,Nc,Ea,Zb,Pb,vc,ga,ac,F,xc,Oc,Pc,Eb,Dc,Ec,f=1,G=-1,Qa=0,hc=!0,fc=!0,Qc={init:function(a,b){Nc||"undefined"===typeof Jacked||(b&&c.extend(l,b),ec=l.className, hb=l.useThumbs,V=l.deepLinking,Va=l.useThumbTooltips,vc=l.autoPlayVideo,Fa=l.useKeyboardControls,Ha=l.showPageScrollbar,ga=l.thumbnailWidth,Mc=l.fullscreenScalesContent,F=l.thumbnailHeight,xc=l.flashVideoFirst,Pc=l.showInfoByDefault,Eb=l.thumbsStartHidden,Oc=l.defaultShareImage,Dc=l.defaultVideoWidth,Ec=l.defaultVideoHeight,ra=l.baseName,Jb=ra+Jb,Hb=ra+Hb,Ib=ra+Ib,Qb=ra+Qb,Rb=ra+Rb,Sb=ra+Sb,r=document,Ga=c(document),Nc=!0,fa=ga+Da,sb=-1!==r.URL.search("file:///"),Jacked.setEngines({ios:!0,safari:!0, opera:!0,firefox:!0}),l.preloadGraphics&&!sb&&c.getJSON(Qb+"?jackbox_path=../img/graphics/",nd),xb=a,ta=Jacked.getIE(),t=Jacked.getMobile(),gb=Jacked.getBrowser(),Lc="ie"===gb,t&&(Ha=!1),"undefined"!==typeof c.address&&V?Lc||l.dynamic?(tb(),c.address.update()):c.address.init(tb):(V=!1,tb()),"undefined"===typeof StackBlurImage||(sb||ta)||c(".jackbox-hover-blur").each(od),c(".jackbox-tooltip").each(qd),l=null)},frameReady:function(){$&&lb()},newItem:function(a,b){a.each(bc,[b])},removeItem:function(a){a.each(bc, [!1,!0])}},Ja=function(){var a={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};return function(b,d,n){a.width=q;a.height=p;a.scrolling=n?"auto":"no";k=c("<iframe />").attr(a);kb?k.addClass("jackbox-youtube"):k.addClass("jackbox-content");k.prependTo(ja);if(!d)k.one("load.jackbox",lb);k.attr("src",b)}}(),lb=function(){var a={};return function(b){b&&b.stopPropagation();Ta&&(S=this.width||k.width(), T=this.height||k.height(),Fc());a.width=q;a.height=p;k.css(a);Rc(!0);Ub&&Ub();I.on("resize.jackbox",Za)}}(),Rc=function(){var a={},b={},d={};return function(c){if(c){260>q&&(Ca+=260-q);c=Math.max(q,260);if(c===La&&p===Xb){Sc();return}a.callback=Sc;a.duration=La?50<Math.abs(c-La)||50<Math.abs(p-Xb)?600:300:600}else c=q,d.width=c,a.duration=300,delete a.callback,A&&Jacked.tween(A[0],d,a),B&&Jacked.tween(B[0],d,a),d.height=p,Jacked.stopTween(k[0],!0),Jacked.tween(k[0],d,a);b.marginLeft=-((Ca>>1)+0.5| 0);b.marginTop=-((Yb>>1)+0.5|0);b.height=p;b.width=c;La||(b.opacity=1);Jacked.tween(s[0],b,a);La=c;Xb=p}}(),Sc=function(){var a={},b={opacity:1,visibility:"visible"};return function(){ud();Y.removeClass("jackbox-spin-preloader");var d=Math.max(q,260);a.duration=600;Ta&&!ta?Jacked.fadeIn(k[0],a):(kb?k.css("visibility","visible"):k.show(),"audio"!==N&&"local"!==N||k[0].contentWindow.cjInit());a.duration=300;ta?(A&&A.css("width",d).show(),B&&B.css("width",d).show()):(A&&(A.css("width",d),Jacked.fadeIn(A[0], a)),B&&(B.css("width",d),Jacked.fadeIn(B[0],a)));y&&jb?(y.show(),O.html(jb).show(),ea=-O.outerHeight(),E.css("height",-ea<p?-ea:p),Pc?(Ma=!0,y.addClass("jb-info-inactive"),O.css({visibility:"visible",marginTop:0})):(Ma=!1,O.css("margin-top",ea))):y&&(y.hide(),O.hide());Sa=!1;!pb&&W&&(ia.css(b),sa.css(b));if(!Pb&&hb&&W){var d=J[G],e=[],g=Q,f,m,l,h,s;for(Pb=!0;g--;)l=d[g],l.attr("data-thumbnail")?e[g]=!1:(f=l.children("img"),f.length?(l.attr("data-thumbnail",f.attr("src")),e[g]=f):("image"===l.data("type")? l.attr("data-thumbnail",l.attr("href")||l.attr("data-href")):l.attr("data-thumbnail",Rb),e[g]=!1));w=[];aa||(g=r.createDocumentFragment(),l=F>>1,aa=c("<div />").addClass("jackbox-thumb-holder").css("height",F).appendTo(v),u=c("<div />").addClass("jackbox-thumb-panel").css("height",F),ca=c("<div />").addClass("jackbox-thumb-right"),ba=c("<div />").addClass("jackbox-thumb-left"),g.appendChild(u[0]),g.appendChild(ca[0]),g.appendChild(ba[0]),u[0].cjThumbs=!0,aa[0].appendChild(g),U=c("<div />").addClass("jackbox-thumb-strip").appendTo(u), ba.css("top",l),ca.css("top",l));l=r.createDocumentFragment();for(g=0;g<Q;g++){m=w[g]=c("<div />").data("id",g).addClass("jackbox-thumb").css({width:ga,height:F,left:fa*g}).on("click.jackbox",Bc);if(Va&&(f=cb[g].attr("data-thumbTooltip")||cb[g].attr("data-title")))m.data("theTitle",f).on("mouseenter.jackbox",vd).on("mouseleave.jackbox",yc);l.appendChild(m[0]);f=c("<img />").addClass("jb-thumb").one("load.jackbox",gd).appendTo(m);m.data("theThumb",f);e[g]?(m=e[g].attr("width")||e[g].width(),h=e[g].attr("height")|| e[g].height()):(m=ga,h=F);m>ga&&h>F&&(s=m>h?ga/m:F/h,m*=s,h*=s,h<F&&(s=(F-h)/F,m+=m*s,h+=h*s),m<ga&&(s=(ga-m)/ga,m+=m*s,h+=h*s),m!==(m|0)&&(m=m+1|0),h!==(h|0)&&(h=h+1|0));f.attr({width:m,height:h,src:d[g].attr("data-thumbnail")})}U[0].appendChild(l);Hc=w.length;Wb=fa*g;L=!0;x=0;aa.on("click.jackbox",tc).show();Tc();z&&(Eb?(da.hide(),X.show(),aa.css("bottom",na)):(X.hide(),da.show(),aa.css("bottom",0)),z.on("click.jackbox",Kb))}if(!pb){pb=!0;if(va)R.on("click.jackbox",hd);if(za)za.one("click.jackbox", Bb);if(y)y.on("click.jackbox",wd);if(W){if(xa)xa.on("click.jackbox",ab);if(wa)wa.on("click.jackbox",bb);if(Va&&u)u.on("mouseenter.jackbox",fd);t&&E&&(E[0].addEventListener("touchstart",pa,!1),E[0].addEventListener("touchmove",pa,!1),E[0].addEventListener("touchend",pa,!1))}}t&&(k[0].removeEventListener("touchstart",C,!1),k[0].removeEventListener("touchmove",C,!1),k[0].removeEventListener("touchend",C,!1),kc());if(W){if(L)for(d=w.length;d--;)w[d].on("click.jackbox",Bc);ia.on("click.jackbox",bb);sa.on("click.jackbox", ab);if(Fa)Ga.on("keydown.jackbox",dd);t&&Ab&&k.cjSwipe("touchSwipe",md)}"inline"===N&&ma()}}(),ud=function(){var a={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};return function(){Ic||(Ic=!0,Wa=c(".jb-total"),y=c(".jackbox-info"),Aa=c(".jb-divider"),Ba=c(".jb-current"),za=c(".jackbox-close"),rb=c(".jackbox-title-text"),D=c(".jackbox-title-txt"),ya=c(".jackbox-controls"),wa=c(".jackbox-arrow-left"), Xa=c(".jackbox-social"),xa=c(".jackbox-arrow-right"),z=c(".jackbox-button-thumbs"),X=c(".jackbox-show-thumbs"),da=c(".jackbox-hide-thumbs"),D.length||(D=null),rb.length||(rb=null),wa.length||(wa=null),Aa.length||(Aa=null),xa.length||(xa=null),ya.length||(ya=null),za.length||(za=null),Xa.length||(Xa=null),Ba.length&&Wa.length||(Ba=null),va?(c(".jackbox-ns").hide(),R.length||(R=va=null)):R&&R.hide(),hb?z.length&&X.length&&da.length?X.hide():z=X=da=null:(z.hide(),z=X=da=null),y.length?(E=c("<div />").addClass("jackbox-info-text").appendTo(ja).css("visibility", "hidden"),O=c("<div />").addClass("jackbox-description-text").appendTo(E)):y=null,Va&&(Ka=c("<span />").addClass("jackbox-thumb-tip").css("bottom",F),Tb=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Ka),Ka.appendTo(v),Gc=(parseInt(Ka.css("padding-left"),10)<<1)-(Da<<1)));W||(ya&&ya.hide(),z&&z.hide());if(rb){"false"===oa&&(oa=!1);var b=D&&oa,d=b?" -&nbsp;":"";Ba&&W?(Ba.text(f+1).show(),Wa.html(Q+d).show(),Aa&&Aa.show()):(Wa&&Wa.hide(),Ba&&Ba.hide(),Aa&&Aa.hide());b&& (D.html(Fb),b=D.find("a"),b.length&&(b.on("click.jackbox",pa),D.data("links",b)))}if(Xa&&!sb){var n,b=r.URL.split("#")[0],d=b.length-1;-1!==b.search("/")&&("/"!==b.charAt(d)?(V?n=b+"#/"+la+"/"+(f+1):n=b,b=b.substring(0,b.lastIndexOf("/"))):(b=b.substring(0,d),V?n=b+"/#/"+la+"/"+(f+1):n=b));Ta?d=e.attr("href")||e.attr("data-href"):(d=e.children("img"),d=d.length?d.attr("src"):Oc);-1===d.search("http")&&(d="/"!==d.charAt(0)?b+"/"+d:b+d);b=oa?oa.replace(/(<([^>]+)>)/ig,""):r.title;b=b.split(".").join(""); a.width=200;a.height=21;a.src=Sb+"?url="+encodeURIComponent(n)+"&poster="+encodeURIComponent(d)+"&title="+escape(b);ob=c("<iframe />").attr(a).appendTo(Xa)}}}(),wd=function(){var a={},b={duration:300};return function(d){d&&d.stopPropagation();Ma?(a.marginTop=ea,b.callback=ed,y.removeClass("jb-info-inactive")):(y.addClass("jb-info-inactive"),E.css("visibility","visible"),a.marginTop=0,delete b.callback);Jacked.tween(O[0],a,b);Ma=!Ma}}(),vd=function(){var a={opacity:1,visibility:"visible"};return function(){t&& (clearTimeout(Kc),Kc=setTimeout(yc,2E3));var b=c(this),d,e,g;Tb.text(b.data("theTitle"));d=parseInt(Tb.css("width"),10);g=u.data("offLeft");b=b.offset().left;e=g+u.width()-d-Gc;a.width=d;a.left=b<g?g:b>e?e:b;Ka.css(a)}}(),Kb=function(){var a={},b={duration:300};return function(d){d&&d.stopPropagation();0===na?(na=wb,z&&(da.hide(),X.show())):(na=0,z&&(X.hide(),da.show()));a.bottom=na;Jacked.tween(aa[0],a,b);569>H||(ma("true"),Rc())}}(),Tc=function(){var a={};return function(b){var d=H-160;Wb<d?(qa= Hc,Zb=!1):(qa=d/fa|0,Zb=!0);qb=fa*qa-Da;Vb=qa-1;a.marginLeft=-(qb>>1)-Da;a.width=qb;u.css(a);U.css("width",Wb);uc(b)}}(),uc=function(){var a={},b={duration:300};return function(d,c){if(d)x=f,0!==f&&f+qa>Q&&(x=Q-qa),Jacked.stopTween(U[0]),U.css("left",x*-fa);else{if(0===f)x=0;else if(f>x+Vb)for(;f>x+Vb;)x++;c?(a.left=x*-fa,Jacked.tween(U[0],a,b)):(Jacked.stopTween(U[0]),U.css("left",x*-fa))}Lb(d,!1)}}(),Lb=function(){var a={},b={duration:300};return function(d,c){ba.off(".jackbox");ca.off(".jackbox"); if(Zb)if(t&&u.cjSwipe("unbindSwipe"),x<Q-qa?(ca.on("click.jackbox",zc).show(),t&&u.cjSwipe("touchSwipeLeft",zc,!0)):ca.hide(),0<x?(ba.on("click.jackbox",Ac).show(),t&&u.cjSwipe("touchSwipeRight",Ac,!0)):ba.hide(),c)a.left=x*-fa,Jacked.tween(U[0],a,b);else{if(d||!Ob){var e=u.offset().left;ba.css("left",e);ca.css("left",e+qb);Ob=!0}}else ba.hide(),ca.hide()}}(),ma=function(){var a={opacity:1},b={};return function(d){H=I.width();M=Math.max(I.height(),226);var c=568<H&&0===na?Db:0;Jc="audio"!==N&&"inline"!== N?Ua?ib||Mc:ib:!1;if(nb<H&&Nb+c<M&&!Jc)q=S,p=T;else{q=H/nb;p=M/Nb;var e=q>p?p:q;q=S*e;p=T*e;H>M?p+eb+c>M&&(p=M-Ia-Z-c,q=S*(p/T)):q>p?q+nb>H&&(q=H-Z,p=T*(q/S)):p+eb+c>M&&(p=M-Ia-Z-c,q=S*(p/T));q!==(q|0)&&(q=q+1|0);p!==(p|0)&&(p=p+1|0)}if("inline"===N){var e=H-db-Cb-Z,f=M-Ia-Z-c;q=S>e?e:S;p=T<f?T:p}Ca=q+db;Yb=p+Ia+c;"true"!==d&&(Jacked.stopTween(s[0],!1,!0),k&&Jacked.stopTween(k[0],!0,!0),260>q&&(Ca+=260-q),d=Math.max(260,q),a.width=d,a.height=p,b.marginLeft=-(0.5*Ca+0.5|0),b.marginTop=-(0.5*Yb+0.5| 0),b.width=d,b.height=p,s.css(b),k.css(a),B&&(Jacked.stopTween(B[0]),B.css("width",d)),A&&(Jacked.stopTween(A[0]),A.css("width",d)),y&&jb&&(ea=-O.outerHeight(),E.css("height",-ea<p?-ea:p),Ma||(Jacked.stopTween(O[0],!1,!0),O.css("margin-top",ea))),L&&Tc(!0))}}(),td=function(){var a={};return function(b){var d=c(this).data();a.left=b.pageX-d.tipX-d.tipWidth;a.top=b.pageY-d.tipY-d.tipHeight;d.tip.css(a)}}();c.fn.jackBox=function(a,b){if(Qc.hasOwnProperty(a))Qc[a](this,b);return this};c.jackBox={available:function(a){a&& (ac?V?setTimeout(a,250):a():Pa=a)},itemLoaded:function(a){Ub=a}}})(jQuery);function jackboxFrameReady(){jQuery.fn.jackBox("frameReady")};